总操纵流程：
- 1、下载安装
- 2、创建项目
- 3、测试

***
# 下载安装

> 1、protoc的下载安裝

- 下载

[![](https://img.shields.io/badge/github-protoc-blued.svg "github protoc")](https://github.com/protocolbuffers/protobuf/releases/tag/v3.8.0-rc1)

- 配置变量环境

```
变量名：  PROTOC_HOME
变量值：  C:\Software\protoc
Path:    ;%PROTOC_HOME%\bin
```

- cmd测试

```
protoc --version
```

> 2、Consul的下载安装

- 下载

[![](https://img.shields.io/badge/官网-Consul-red.svg "官网 Consul")](https://www.consul.io/downloads.html)

- 配置变量环境

```
变量名： CONSUL_HOME
变量值： C:\Software\consul
Path:  ;%CONSUL_HOME%
```

- 添加window注册服务

```
sc.exe create "Consul Server" binPath="C:\Software\consul\consul.exe agent -dev"
```

- 启动

```
consul agent -dev
```

> 3、下载安装go的组件

```go
go get -v github.com/golang/protobuf/proto
go get -v github.com/golang/protobuf/protoc-gen-go
go get -v github.com/micro/go-micro
go get -v github.com/micro/protoc-gen-micro
```

# 创建项目

> 1、在src文件夹下创建文件夹和文件

-  test
    - greeter
        - greeter.proto
    - service
        - service.go
    - client
        - client.go

`greeter.proto`

```go
syntax = "proto3";
 
service Greeter {
    rpc Hello(HelloRequest) returns (HelloResponse) {}
}
 
message HelloRequest {
    string name = 1;
}
 
message HelloResponse {
    string greeting = 2;
}
```

`service.go`

```go
package main
  
import (
    "context"
    "fmt"
  
    micro "github.com/micro/go-micro"
    proto "test/greeter" //这里写你的proto文件放置路劲
)
  
type Greeter struct{}
  
func (g *Greeter) Hello(ctx context.Context, req *proto.HelloRequest, rsp *proto.HelloResponse) error {
    rsp.Greeting = "Hello " + req.Name
    return nil
}
  
func main() {
    // Create a new service. Optionally include some options here.
    service := micro.NewService(
        micro.Name("greeter"),
    )
  
    // Init will parse the command line flags.
    service.Init()
  
    // Register handler
    proto.RegisterGreeterHandler(service.Server(), new(Greeter))
  
    // Run the server
    if err := service.Run(); err != nil {
        fmt.Println(err)
    }
}
```

`client.go`

```go
package main
  
import (
    "context"
    "fmt"
  
    micro "github.com/micro/go-micro"
    proto "test/greeter" //这里写你的proto文件放置路劲
)
  
  
func main() {
    // Create a new service. Optionally include some options here.
    service := micro.NewService(micro.Name("greeter.client"))
    service.Init()
  
    // Create new greeter client
    greeter := proto.NewGreeterService("greeter", service.Client())
  
    // Call the greeter
    rsp, err := greeter.Hello(context.TODO(), &proto.HelloRequest{Name: "老兵"})
    if err != nil {
        fmt.Println(err)
    }
  
    // Print response
    fmt.Println(rsp.Greeting)
}
```

> 2、编译.proto文件

```
cd  d:/goWork/src/test/greeter

C:\Software\protoc\bin\protoc.exe  --plugin=protoc-gen-go=D:\goWork\bin\protoc-gen-go.exe --go_out . --micro_out=.  --proto_path .  greeter.proto
```

# 测试

- 开两个vscode控制台

```go
cd cd  d:/goWork/src/test/service

go run service.go
```


```go
cd cd  d:/goWork/src/test/client

go run client.go
```

进入浏览器输入地址查看：http://localhost:8500